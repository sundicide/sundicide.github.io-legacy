<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Week3-2: Type Classes - sundicide</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">sundicide</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../../.." class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Scala <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../" class="dropdown-item">Welcome</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Coursera</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../" class="dropdown-item">Index</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Fpd in scala</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../" class="dropdown-item">Index</a>
</li>
            
<li>
    <a href="../week3_1-typedirectedprogramming/" class="dropdown-item">Week3-1: Type-Directed Programming</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Week3-2: Type Classes</a>
</li>
            
<li>
    <a href="../week3_3-ConditionalImplicitDefinitions/" class="dropdown-item">Week3-3: Conditional Implicit Definitions</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../week3_1-typedirectedprogramming/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../week3_3-ConditionalImplicitDefinitions/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#week3-2-type-classes" class="nav-link">Week3-2: Type Classes</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#retroactive-extension" class="nav-link">Retroactive Extension</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#laws" class="nav-link">Laws</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#example-of-type-class-ring" class="nav-link">Example of Type Class: Ring</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#summary" class="nav-link">Summary</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="week3-2-type-classes">Week3-2: Type Classes</h1>
<p>In the previous lectures we have seen a particular pattern of code combining parameterized types and implicits.
We have defined a parameterized type Ordering[A], implicit instances of that type for concrete types A, and implicit parameters of type Ordering[A]:</p>
<pre><code class="scala">trait Ordering[A] {
  def compare(a1: A, a2: A): Int
}

object Ordering {
  implicit val Int: Ordering[Int] =
    new Ordering[Int] {
      def compare(x: Int, y: Int) = if (x &lt; y) -1 else if (x &gt; y) 1 else 0
    }
  implicit val String: Ordering[String] =
    new Ordering[String] {
      def compare(s: String, t: String) = s.compareTo(t)
  }
}

def sort[A: Ordering](xs: List[A]): List[A] = ...
</code></pre>

<p>We say that Ordering is a type class.</p>
<p>Type classes provide yet another form of polymorphism.
The method sort can be called with lists containing elements of any type A for which there is an implicit value of type Ordering[A].</p>
<p>At compile-time, the compiler resolves the specific Ordering implementation that matches the type of the list elements.</p>
<h2 id="retroactive-extension">Retroactive Extension</h2>
<p>Type classes let us add new features to data types without changing the original definition of these data types. For instance, consider the following Rational type, modeling a rational number:</p>
<pre><code class="scala">/** A rational number
  * @param num   Numerator
  * @param denom Denominator
  */
case class Rational(num: Int, denom: Int)
</code></pre>

<p>We can add the capability "to be compared" to the type Rational by defining an implicit instance of type Ordering[Rational]:</p>
<pre><code class="scala">object RationalOrdering {
  implicit val orderingRational: Ordering[Rational] =
    new Ordering[Rational] {
      def compare(q: Rational, r: Rational): Int =
        q.num * r.denom - r.num * q.denom
    }
}
</code></pre>

<h2 id="laws">Laws</h2>
<p>So far, we have shown how to implement instances of a type class, for some specific types (Int, String, and Rational).</p>
<p>Now, let’s have a look at the other side: how to use (and reason about) type classes.</p>
<p>For example, the sort function is written in terms of the Ordering type class, whose implementation is itself defined by each specific instance, and is therefore unknown at the time the sort function is written. If an Ordering instance implementation is incorrect, then the sort function becomes incorrect too!</p>
<p>To prevent this from happening, type classes are often accompanied by laws, which describe properties that instances must satisfy, and that users of type classes can rely on.</p>
<p>Can you think of properties that instances of the type class Ordering must satisfy, so that we can be confident that the method sort won’t be broken?</p>
<p>Instances of the Ordering[A] type class must satisfy the following properties:</p>
<ul>
<li>inverse: the sign of the result of comparing x and y must be the inverse of the sign of the result of comparing y and x,</li>
<li>transitive: if a value x is lower than y and that y is lower than z, then x must also be lower than z,</li>
<li>consistent: if two values x and y are equal, then the sign of the result of comparing x and z should be the same as the sign of the result of comparing y and z.</li>
</ul>
<p>The authors of a type class should think about such kind of laws and they should provide ways for instance implementers to check that these laws are satisfied.</p>
<h2 id="example-of-type-class-ring">Example of Type Class: Ring</h2>
<p>Let’s see how we can define a type class modeling a ring structure. A ring is an algebraic structure defined as follows according to Wikipedia:</p>
<p>In mathematics, a ring is one of the fundamental algebraic structures used in abstract algebra. It consists of a set equipped with two binary operations that generalize the arithmetic operations of addition and multiplication. Through this generalization, theorems from arithmetic are extended to non-numerical objects such as polynomials, series, matrices and functions.</p>
<p>This structure is so common that, by abstracting over the ring structure, developers could write programs that could then be applied to various domains (arithmetic, polynomials, series, matrices and functions).</p>
<p>A ring is a set equipped with two binary operations, + and *, satisfying the following laws (called the ring axioms):</p>
<p>(a + b) + c = a + (b + c)   + is associative
a + b = b + a   + is commutative
a + 0 = a   0 is the additive identity
a + -a = 0  -a is the additive inverse of a
(a * b) * c = a * (b * c)   * is associative
a * 1 = a   1 is the multiplicative identity
a * (b + c) = a * b + a * c left distributivity
(b + c) * a = b * a + c * a right distributivity
Here is how we can define a ring type class in Scala:</p>
<pre><code class="scala">trait Ring[A] {
  def plus(x: A, y: A): A
  def mult(x: A, y: A): A
  def inverse(x: A): A
  def zero: A
  def one: A
}
</code></pre>

<p>Here is how we define an instance of Ring[Int]:</p>
<pre><code class="scala">object Ring {
  implicit val ringInt: Ring[Int] = new Ring[Int] {
    def plus(x: Int, y: Int): Int = x + y
    def mult(x: Int, y: Int): Int = x * y
    def inverse(x: Int): Int = -x
    def zero: Int = 0
    def one: Int = 1
  }
}
</code></pre>

<p>Finally, this is how we would define a function that checks that the + associativity law is satisfied by a given Ring instance:</p>
<pre><code class="scala">def plusAssociativity[A](x: A, y: A, z: A)(implicit ring: Ring[A]): Boolean =
  ring.plus(ring.plus(x, y), z) == ring.plus(x, ring.plus(y, z))
</code></pre>

<p>Note: in practice, the standard library already provides a type class Numeric, which models a ring structure.</p>
<h2 id="summary">Summary</h2>
<p>In this lesson we have identified a new programming pattern: type classes.</p>
<p>Type classes provide a form of polymorphism: they can be used to implement algorithms that can be applied to various types. The compiler selects the type class implementation for a specific type at compile-time.</p>
<p>A type class definition is a trait that takes type parameters and defines operations that apply to these types. Generally, a type class definition is accompanied by laws, checking that implementations of their operations are correct.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
